<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>DaoDaoLeeのBlog</title>
  
  <subtitle>所谓的迷茫，不过是清醒的看着自己沉沦</subtitle>
  <link href="https://daodaolee.cn/atom.xml" rel="self"/>
  
  <link href="https://daodaolee.cn/"/>
  <updated>2021-01-25T07:54:09.324Z</updated>
  <id>https://daodaolee.cn/</id>
  
  <author>
    <name>DaoDaoLee</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>http的option请求</title>
    <link href="https://daodaolee.cn/2019/06/24/http%E7%9A%84option%E8%AF%B7%E6%B1%82/"/>
    <id>https://daodaolee.cn/2019/06/24/http%E7%9A%84option%E8%AF%B7%E6%B1%82/</id>
    <published>2019-06-24T10:50:08.000Z</published>
    <updated>2021-01-25T07:54:09.324Z</updated>
    
    <content type="html"><![CDATA[<p>先看两张图：</p><p><img src="https://i.loli.net/2019/06/20/5d0b73254660812409.png"></p><p><img src="https://i.loli.net/2019/06/20/5d0b732a2829499623.png"></p><p>流程是这样：选择支付方式，填入充值金额，跳转到“选择银行卡界面”，但是在跳转的过程中走了2次<code>get_card</code>请求。</p><p>由于模块是H5纯静态页面，肯定会遇到跨域的问题，之前是用<code>jsonp</code>解决的，但是现在需要给后端传一堆<code>headers</code> 头部信息，然后，jsonp就不行了，因为他的实质是src标签，然后用callback传的，而且只能传get，所以这次接口的改动，只能让后端配置CORS了，也就是<code>Allow-Control-Allow-Origin: *</code> 和<code>Allow-Control-Allow-Methods:GET,POST</code> 让后端配置这个就可以了，再保险点，把<code>*</code> 变成<code>访问地址</code> ，然后就出现了上面的情况，第一次的<code>Request Method:OPTION</code> ，而且没有发送请求头，第二次就是 正常的post了。</p><p>出现第一次的原因是探测请求，客户端可以在采取具体资源请求之前，决定对该资源采取何种必要措施，或者了解服务器的性能。</p><blockquote><p>在ajax中出现options请求，也是一种提前探测的情况，ajax跨域请求时，如果请求的是json，就属于复杂请求，因此需要提前发出一次options请求，用以检查请求是否是可靠安全的，如果options获得的回应是拒绝性质的，比如404\403\500等http状态，就会停止post、put等请求的发出。</p></blockquote><p>如果你查资料(W3C规范)，你会发现在跨域请求中，分为简单请求（get和部分post，post时content-type属于application/x-www-form-urlencoded，multipart/form-data，text/plain中的一种）和复杂请求。而复杂请求发出之前，就会出现一次options请求。</p><p>参考资料：</p><p><a href="http://www.tangshuang.net/2271.html">jquery ajax 请求中多出现一次OPTIONS请求及其解决办法</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;先看两张图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.loli.net/2019/06/20/5d0b73254660812409.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.loli.net/2019/06/20/5d0b732a282</summary>
      
    
    
    
    <category term="FE" scheme="https://daodaolee.cn/categories/FE/"/>
    
    <category term="http" scheme="https://daodaolee.cn/categories/FE/http/"/>
    
    
    <category term="http" scheme="https://daodaolee.cn/tags/http/"/>
    
    <category term="option" scheme="https://daodaolee.cn/tags/option/"/>
    
  </entry>
  
  <entry>
    <title>form表单提交的submit和ajax区别</title>
    <link href="https://daodaolee.cn/2019/01/23/form%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E7%9A%84submit%E5%92%8Cajax%E5%8C%BA%E5%88%AB/"/>
    <id>https://daodaolee.cn/2019/01/23/form%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4%E7%9A%84submit%E5%92%8Cajax%E5%8C%BA%E5%88%AB/</id>
    <published>2019-01-23T13:05:22.000Z</published>
    <updated>2021-01-25T07:54:07.450Z</updated>
    
    <content type="html"><![CDATA[<h2 id="页面"><a href="#页面" class="headerlink" title="页面"></a>页面</h2><ul><li>submit：更新数据完成后，需要<strong>转到一个空白的页面</strong>再对原页面进行提交后的处理，即重绘。</li><li>ajax：异步进行，直接返回原页面进行提交后的处理，比submit少增加一个页面，即局部刷新。</li></ul><h2 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h2><ul><li>ajax：出于安全性的考虑，不能对文件进行操作，所以不可以通过ajax来实现文件上传</li><li>submit：通过隐藏form的submit可以实现文件上传</li></ul><h2 id="form默认提交"><a href="#form默认提交" class="headerlink" title="form默认提交"></a>form默认提交</h2><p>如果想要submit后<strong>不刷新页面</strong>，在该方法的最后加上 <code>return false</code> ，就可以了。</p><p><em><code>return false</code> 的含义不是阻止事件继续向顶层元素传播，而是阻止浏览器对事件的默认处理方式。在js中，它的作用一般是用来取消默认动作的。</em></p><p><em><code>return false</code> 等效于 <code>window.event.returnValue = false</code></em> 。</p><blockquote><p>因为原页面用 form 提交到另一个域名之后，原页面的脚本无法获取新页面中的内容。所以浏览器认为这是安全的。而 AJAX 是可以读取响应内容的，因此浏览器不能允许你这样做。 如果你细心的话你会发现，其实请求已经发送出去了，你只是拿不到响应而已。 所以浏览器这个策略的本质是，一个域名的 JS ，在未经允许的情况下，不得读取另一个域名的内容。但浏览器并不阻止你向另一个域名发送请求。 ——来自知乎</p></blockquote><p>有关同源策略和跨域，可以参考 <a href="https://mp.weixin.qq.com/s?__biz=MzU0OTExNzYwNg==&mid=2247483685&idx=1&sn=543e9736146405e9e5b37ec5a1c4b448">跨域的那些事儿</a></p><p>参考资料：</p><p><a href="https://www.cnblogs.com/zhujiabin/p/4901167.html">Ajax提交与传统Form表单提交的区别说明</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;页面&quot;&gt;&lt;a href=&quot;#页面&quot; class=&quot;headerlink&quot; title=&quot;页面&quot;&gt;&lt;/a&gt;页面&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;submit：更新数据完成后，需要&lt;strong&gt;转到一个空白的页面&lt;/strong&gt;再对原页面进行提交后的处理，即重绘。&lt;/l</summary>
      
    
    
    
    <category term="FE" scheme="https://daodaolee.cn/categories/FE/"/>
    
    <category term="form" scheme="https://daodaolee.cn/categories/FE/form/"/>
    
    
    <category term="form" scheme="https://daodaolee.cn/tags/form/"/>
    
    <category term="ajax" scheme="https://daodaolee.cn/tags/ajax/"/>
    
  </entry>
  
</feed>
